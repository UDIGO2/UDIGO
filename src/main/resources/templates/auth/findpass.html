<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>비밀번호 찾기</title>
  <link rel="stylesheet" th:href="@{/css/header.css}">
  <link rel="stylesheet" th:href="@{/css/footer.css}">
  <link rel="stylesheet" th:href="@{/css/findpass.css}">
</head>
<body>

<div th:replace="~{fragments/header :: header}"></div>

  <div id="change-password-page">
      <main class="main-content">
        <form id="findPassForm" action="/auth/findpass" method="post" onsubmit="return false;">
          <h2>비밀번호 찾기</h2>
          <label for="memberId">아이디:</label>
          <input type="text" id="memberId" name="memberId" required>

          <label for="email">이메일:</label>
          <input type="email" id="email" name="email" required>

          <button type="submit">비밀번호 찾기</button>
        </form>


        <div id="modal" class="modal" th:if="${success}">
          <div class="modal-content">
            <p th:text="${success}"></p>
            <button onclick="closeModal()">확인</button>
          </div>
        </div>

      </main>
    <div th:replace="~{fragments/footer :: footer}"></div>
</div>

<script>
  document.getElementById("findPassForm").addEventListener("submit", function(event) {
    event.preventDefault();

    const formData = new FormData(this);

    fetch("/auth/findpass", {
      method: "POST",
      body: formData
    })
            .then(response => response.text())
            .then(data => {
              console.log("서버 응답:", data);

              alert("이메일이 전송되었습니다. 로그인 화면으로 이동합니다.");
              window.location.href = "/auth/login";
            })
            .catch(error => {
              console.error("비밀번호 찾기 오류:", error);
              alert("서버와의 통신 중 오류가 발생했습니다.");
            });
  });

  function closeModal() {
    document.getElementById("modal").style.display = "none";
    window.location.href = "/auth/login";
  }
</script>

</body>
</html>
